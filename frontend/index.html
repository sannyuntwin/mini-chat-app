<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Mini Chat</title>
<style>
body { font-family: Arial; max-width: 600px; margin: 20px auto; }
#chat { border: 1px solid #ccc; height: 400px; overflow-y: auto; padding: 10px; background:#f9f9f9; }
#input { margin-top:10px; display:flex; gap:5px; }
#msg { flex:1; }
</style>
</head>
<body>
<h2>Mini Chat</h2>
<input id="name" placeholder="Username"/>
<div id="chat"></div>
<div id="input">
<input id="msg" placeholder="Message"/>
<button id="send">Send</button>
</div>
<script>
const chatEl = document.getElementById('chat')
const nameEl = document.getElementById('name')
const msgEl = document.getElementById('msg')
const sendBtn = document.getElementById('send')
const WS_HOST = "ws://localhost:8000/ws"
let ws = new WebSocket(WS_HOST)

ws.onopen = () => addSystem("Connected")
ws.onmessage = e => addMessage(e.data)
ws.onclose = () => addSystem("Disconnected")

sendBtn.onclick = send
msgEl.addEventListener('keydown', e=>{if(e.key==='Enter') send()})

function send(){
  const name = nameEl.value || 'anon'
  const msg = msgEl.value
  if(!msg) return
  ws.send(`${name}|${msg}`)
  msgEl.value=''
}

function addMessage(txt){ const p=document.createElement('p'); p.innerHTML=txt; chatEl.appendChild(p); chatEl.scrollTop=chatEl.scrollHeight }
function addSystem(txt){ const p=document.createElement('p'); p.style.color='#888'; p.textContent=txt; chatEl.appendChild(p); chatEl.scrollTop=chatEl.scrollHeight }
</script>
</body>
</html>
